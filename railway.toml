[build]
builder = "DOCKERFILE"
dockerfilePath = "apps/api/Dockerfile"
watchPaths = ["apps/api/**", "packages/**"]

[deploy]
rootDirectory = "/"
startCommand = "node dist/server.js"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10
healthcheckPath = "/graphql"
healthcheckTimeout = 100

# Variables de entorno no-secretas
# Los secrets (DATABASE_URL, JWT_SECRET, etc.) agregalos manualmente en Railway UI
[[env]]
name = "NODE_ENV"
value = "production"

[[env]]
name = "PORT"
value = "4000"

[[env]]
name = "JWT_EXPIRES_IN"
value = "15m"

[[env]]
name = "JWT_REFRESH_EXPIRES_IN"
value = "7d"

# Secrets - DEBES CAMBIAR ESTOS VALORES
[[env]]
name = "DATABASE_URL"
value = "CAMBIAR_postgresql://neondb_owner:password@ep-xxx.neon.tech/neondb?schema=solufacil_mono&sslmode=require"

[[env]]
name = "JWT_SECRET"
value = "CAMBIAR_zX+xsmZUTHR4/6J6Qxu6ZvVM+Q/6sx+38GdqQcBCGWU="

[[env]]
name = "JWT_REFRESH_SECRET"
value = "CAMBIAR_d9posQOWTreAo2fR7vtQMulIaVWK6Jsq+dKBD5OPfTI="

[[env]]
name = "CORS_ORIGIN"
value = "CAMBIAR_https://tu-app.vercel.app"

[[env]]
name = "CLOUDINARY_CLOUD_NAME"
value = "CAMBIAR_tu-cloud-name"

[[env]]
name = "CLOUDINARY_API_KEY"
value = "CAMBIAR_tu-api-key"

[[env]]
name = "CLOUDINARY_API_SECRET"
value = "CAMBIAR_tu-api-secret"
